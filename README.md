## 介绍
> 自用脚本：主要根据当前小号(农场号)的进度添加功能

基于Open cv 模板匹配的脚本，模板图基于960x540的设备。对于其他分辨率识别效果不一定好(可能不能正常完成操作)。

## 已有能力

> 农场还差个踢人和捐赠装备吧，暂时没需求

主线图支持进度

- [x] 主线普通图支持1-1到4-5 15-10到15-14
- [x] 主线困难图支持1-1到15-3
- [x] 主线图剧情引导跳过支持1-3至2-12

***
- [x] 竞技场/公主竞技场
- [x] 圣迹调查
- [x] 探索
- [x] 公会战
- [x] 扫荡普通或困难图
- [x] 行会点赞
- [x] 地下城Normal图/可以选择支援/可以中途放弃（农场相关）
- [x] 领取公会小屋体力
- [x] 购买体力
- [x] 支持兰德索尔杯活动
- [x] 自动抽取免费十连功能
- [x] 申请加入工会功能（农场相关）
- [x] 自动强化前五个角色
- [x] 购买1/10/20次mana功能
- [x] 支持使用win32api对模拟器进行截图（只支持雷电模拟器）
- [x] 实名认证（只支持雷电模拟器）
- [x] 关闭战斗动画
- [x] 领取任务奖励
- [x] 多设备登录及切换账号

## 使用引导

* 操作需要依赖adb命令，请确保adb命令可用。如何安装可以百度搜索关键字“安装adb”
* 安装Python3环境，访问[Python官网](https://www.python.org/)安装
* 使用git clone或网页下载本项目到电脑上
* 进入项目根目录执行以下命令安装项目所需依赖
  ```cmd
  pip install -r .\requirements.txt
  ```
* 在项目根目录创建`config.yml`文件，根据yaml语法配置账号信息及需要做的任务模块，具体可参考[sample.yml](sample.yml)这个文件
* 执行脚本之前，首先打开模拟器并打开游戏界面停留在欢迎页面
* 在当前目录cmd中执行以下命令启动脚本
  ```cmd
  python main.py
  ```
---
* 使用雷电模拟器多开注意模拟器标题不要改，并且要保证模拟器标题`雷电模拟器-1`这个后面的`-数字`要和多开器里显示的序号一致

## 配置信息

配置默认的账号及需要做哪些任务等信息，需要在工程目录下创建`config.yml`的文件，具体可参考根目录下[sample.yml](sample.yml)文件

```yaml
Accounts: #存账号信息
  -
    account: account1
    password: password1
  -
    account: account2
    password: password2
IDS: &IDS #用于实名认证的信息
  -
    id: 身份证号
    name: 张三
Extra:
  guildname: &guildname 行会名称
  dnpath: 'N:\dnplayer2'
Task: #配置执行任务,配置任务名称，如果需要传入参数在下面增加参数，可以根据不同的账号序号配置任务。
      #账号会执行小于等于并且离它最近的序号的任务列表
  1: #配置账号大于等于1的进行以下操作
    -
      - get_quest_reward #领取任务奖励
    -
      - tohomepage #回到首页
    -
      - buy_mana #购买mana
      - 20 #买20次
    -
      - saodang
      - 1 #第一章
      - 9 #level 9
      - 60 #扫荡60次
    -
      - tohomepage
    -
      - get_quest_reward
```

## 其他

* ADB默认不支持中文输入，中文输入使用的是雷电模拟器的接口。所以如果要使用实名认证功能，需要使用雷电模拟器并传入雷电模拟器的安装目录。**并且由于使用Windows应用程序的命令，会触发防火墙。可以关闭后使用，或者手点下允许。**
* win32api带来的提升还是很高的，使用win32api截图时间平均在0.003秒左右，而使用adb截图耗时浮动在1-2秒。由于win32api的方式需要获取模拟器的窗口信息，这个需要根据模拟器来适配。